{
    "contents" : "\n# Statistical Inference Project Part 1 (Simulation)\n## author: Robert Nield\n\nWe will be simulating the exponential distribution in R with `rexp(n, rate)` (from the documentation rexp(n, rate = 1)). The rate will be signified by $\\lambda.\n\n* $1/\\lambda$ is the mean of the expoential distribution.\n* The standard deviation is $1/\\lambda$. \n\n### Simulation:\nwe set $\\lambda$ (the rate) to 0.2. \nIn this simulation, will take the averages of 40 numbuers sampled from the distribution.\nWe will do 1000 simulated averages of the 40 exponentials.\n\n\n```{r}\nset.seed(1234)\nlambda <- 0.2\nnumber_of_simulation <- 1000\nsize_of_sample <- 40\n\n# Create the simluation\nsim <- matrix(rexp(number_of_simulation*size_of_sample, rate=lambda), number_of_simulation, size_of_sample)\n\n#now take an average of the simluations\nrow_avgs <- rowMeans(sim)\n```\n\n### Now we will plot the sample means\n\n```{r echo=TRUE}\n# plot the histogram of averages\nhist(row_avgs, breaks=50, prob=TRUE,\n     main=\"Distribution of averages, drawn from exp_r with lambda (rate) 0.2\", xlab=\"\")\n\n# Now we will add the density\nlines(density(row_avgs))\n\n\n# plot the theoretical center of distribution\nabline(v=1/lambda, col=\"red\")\n\n# plot theoretical density of the averages of samples\nxfit <- seq(min(row_avgs), max(row_avgs), length=100)\n\nyfit <- dnorm(xfit, mean=1/lambda, sd=(1/lambda/sqrt(size_of_sample)))\n\nlines(xfit, yfit, pch=22, col=\"red\", lty=2)\n# Place legend on the screen\nlegend('topright', c(\"simulation\", \"theoretical\"), lty=c(1,2), col=c(\"black\", \"red\"))\n```\n\n* The sample means is centered at `r mean(row_avgs)`\n* The theoretical center of the distribution is $\\lambda^{-1}$ = `r 1/lambda`.\n\n\n* The variance of sample means is `r var(row_avgs)`\n* The theoretical variance is $\\sigma^2 / n = 1/(\\lambda^2 n) = 1/(0.04 \\times 40)$ =\n`r 1/(0.04 * 40)`.\n\n** We can use the central limit therom to find the averages.\n\n\n## We will not look at normality.\n\n```{r echo=TRUE}\nqqnorm(row_avgs) \nqqline(row_avgs)\n```\n\n## We will then look at the coverage of the confidence interval for\n$1/\\lambda = \\bar{X} \\pm 1.96 \\frac{S}{\\sqrt{n}}$\n\n```{r echo=TRUE}\nlambda_values <- seq(4, 6, by=0.01)\n\n## Find coverage using sapply from the lamda_values\ncoverage <- sapply(lambda_values, function(lamb) {\n    mu_h <- rowMeans(matrix(rexp(size_of_sample*number_of_simulation, rate=0.2),\n                            number_of_simulation, size_of_sample))\n    \n    ul <- mu_h + qnorm(0.975) * sqrt(1/lambda**2/size_of_sample)\n    \n    ll <- mu_h - qnorm(0.975) * sqrt(1/lambda**2/size_of_sample)\n    \n    mean(ll < lamb & ul > lamb)\n})\n\nlibrary(ggplot2)\nqplot(lambda_values, coverage) + geom_hline(yintercept=0.95)\n```\n\n## Summary\n* The 95% confidence intervals for the rate parameter ($\\lambda$) to be estimated\n($\\hat{\\lambda}$) are\n$\\hat{\\lambda}_{low} = \\hat{\\lambda}(1 - \\frac{1.96}{\\sqrt{n}})$ agnd\n$\\hat{\\lambda}_{upp} = \\hat{\\lambda}(1 + \\frac{1.96}{\\sqrt{n}})$.\n\n* For selection of $\\hat{\\lambda}$ around 5, the average of the sample mean falls within the confidence interval at least 95% of the time.\n\n* The true rate, $\\lambda$ is 5.",
    "created" : 1422139839720.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3897289390",
    "id" : "4CE15942",
    "lastKnownWriteTime" : 1422139861,
    "path" : "~/CODE/datasciencecoursera/statisticalinference/Project 1.Rmd",
    "project_path" : "Project 1.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}